@using Microsoft.AspNetCore.Identity
@using Microsoft.AspNetCore.Http
@using Microsoft.CodeAnalysis.CSharp
@model UserAdminViewModel
@{ ViewBag.Title = "UserAdminMyUsers";
    Layout = "_Layout"; }

<div>
    <br />
    <div>
        <img class="rounded float-right" style="max-width: 120px;" src="~/Images/logo.png" />
        <h1> All my users:</h1>
    </div>
    <br />

    <div>
        <a class="btn bg-opacity-blue" type="button" asp-area="Identity" asp-page="/Account/Register">Add user</a>
        <a class="btn bg-opacity-blue" type="button" onclick="location.href = '@Url.Action("GenerateMyUsersReport", "UserAdmin")'">Save complete report</a>
    </div>
    <br /><br />
    <div>
        <table class="mytable table-striped">
            <thead >
            <tr class="bg-opacity-blue">
                <td style="font-size: 15px">
                    Name
                </td>
                <td style="font-size: 15px">
                    Phone
                </td>
                <td style="font-size: 15px">
                    Email
                </td>
                <td style="font-size: 15px">
                    Address
                </td>
                <td style="font-size: 15px">
                    Paymentmethod
                </td>
                <td style="font-size: 15px">
                    Payment due date
                </td>
                <td >
                    @Html.Display("Actions")
                </td>
            </tr>
            </thead>
            <tbody>
            @foreach (var item in Model.MyUsers)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.Name)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PhoneNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Email)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Address.StreetAddress)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PaymentMethod)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PaymentDueDate)
                    </td>
                    <td>
                        <input type="button" id="InputButtonUserAdmin" style="background-color:lightgray" value="Edit" onclick="location.href = '@Url.Action("EditUser", "UserAdmin", new {email = item.Email})'" /> |
                        <input type="button" id="InputButtonUserAdmin" style="background-color:lightgray" value="History" class="btn-primary" onclick="$('#@item.Id').collapse('toggle')" /> |
                        <input type="button" id="InputButtonUserAdmin" style="background-color:lightgray" value ="Delete" onclick="location.href = '@Url.Action("DeleteUser", "UserAdmin", new {username = item.Email})'" />
                    </td>
                </tr>
                <tr id="">
                    <td colspan="6">
                        <div class="collapse testAlignText" id="@item.Id">
                            @if(item.LaundryHistory.Count ==0)
                            {
                                <p>There is no laundry history</p>
                            }
                            else
                            { 
                                foreach (var logEntry in item.LaundryHistory)
                                {
                                    <label style="padding-right: 8px">Date: </label>
                                    @Html.DisplayFor(modelItem => logEntry.LogDate)
                                    <label style="padding-left: 20px">Info: </label>
                                    @Html.DisplayFor(modelItem => logEntry.LogInfo)
                                    <br/>
                                }
                            }
                        </div>
                    </td>
                </tr>}
            </tbody>
        </table>
    </div>
</div>

@*<script>
    $(document).ready(function () {
        $(".btn-primary").click(function () {
            $(".collapse").collapse('toggle');
        });
    });
</script>*@

